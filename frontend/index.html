<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Arbres remarquables de Paris</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>Arbres remarquables de Paris</h1>

  <h2>Nombre dâ€™arbres par arrondissement</h2>
  <canvas id="chartArr" width="400" height="200"></canvas>

  <h2>Hauteur moyenne par arrondissement</h2>
  <canvas id="chartHeight" width="400" height="200"></canvas>

  <h2>RÃ©partition par genre</h2>
  <canvas id="chartGenre" width="400" height="200"></canvas>

  <script>
    // ðŸ”¹ 1. Nombre dâ€™arbres par arrondissement
    fetch("http://localhost:8081/api/count_by_arr")
      .then(res => res.json())
      .then(data => {
        console.log("count_by_arr:", data); // debug
        const labels = data.map(d => d.arr);
        const values = data.map(d => d.count);

        new Chart(document.getElementById("chartArr"), {
          type: "bar",
          data: {
            labels: labels,
            datasets: [{
              label: "Nombre dâ€™arbres",
              data: values,
              backgroundColor: "rgba(54, 162, 235, 0.6)"
            }]
          }
        });
      });

    // ðŸ”¹ 2. Hauteur moyenne par arrondissement
    fetch("http://localhost:8081/api/avg_height_by_arr")
      .then(res => res.json())
      .then(data => {
        console.log("avg_height_by_arr:", data); // debug
        const labels = data.map(d => d.arr);
        const values = data.map(d => d.avg_hauteur);

        new Chart(document.getElementById("chartHeight"), {
          type: "bar",
          data: {
            labels: labels,
            datasets: [{
              label: "Hauteur moyenne (m)",
              data: values,
              backgroundColor: "rgba(75, 192, 192, 0.6)"
            }]
          }
        });
      });

    // ðŸ”¹ 3. RÃ©partition par genre
    fetch("http://localhost:8081/api/count_by_genre")
      .then(res => res.json())
      .then(data => {
        console.log("count_by_genre:", data); // debug
        const labels = data.map(d => d.genre);
        const values = data.map(d => d.count);

        new Chart(document.getElementById("chartGenre"), {
          type: "pie",
          data: {
            labels: labels,
            datasets: [{
              label: "RÃ©partition par genre",
              data: values,
              backgroundColor: [
                "rgba(255, 99, 132, 0.6)",
                "rgba(54, 162, 235, 0.6)",
                "rgba(255, 206, 86, 0.6)",
                "rgba(75, 192, 192, 0.6)",
                "rgba(153, 102, 255, 0.6)"
              ]
            }]
          }
        });
      });
  </script>
</body>
</html>
